from django import forms
from .models import Message

class MessageForm(forms.ModelForm):
    # Pole z wyborem kodu kierunkowego
    phoneCode = forms.ChoiceField(
        choices=[],
        label="Kod kierunkowy",
        widget=forms.Select(attrs={'class': 'form-control'})
    )
    
    phoneNumber = forms.CharField(
        max_length=15,
        label="Numer telefonu",
        widget=forms.TextInput(attrs={
            'class': 'form-control',
            'placeholder': 'Pozostała część numeru'
        })
    )
    
    class Meta:
        model = Message
        fields = ['sender', 'email', 'phoneCode', 'phoneNumber', 'content']
        widgets = {
            'sender': forms.TextInput(attrs={
                'class': 'form-control',
                'placeholder': 'Imię i nazwisko'
            }),
            'email': forms.EmailInput(attrs={
                'class': 'form-control',
                'placeholder': 'adres@email.com'
            }),
            'content': forms.Textarea(attrs={
                'class': 'form-control',
                'placeholder': 'Treść wiadomości...',
                'rows': 5
            }),
        }
        labels = {
            'sender': 'Nadawca',
            'email': 'Email',
            'content': 'Treść wiadomości',
        }
    
    def __init__(self, *args, **kwargs):
        super().__init__(*args, **kwargs)
        # Dynamiczne ustawienie choices dla phoneCode
        self.fields['phoneCode'].choices = self.get_country_codes()
    
    @staticmethod
    def get_country_codes():
        """
        Zwraca listę kodów kierunkowych krajów
        Format: (kod, "kod - kraj")
        """
        COUNTRY_CODES = [
            (1, "1 - Stany Zjednoczone/Kanada"),
            (7, "7 - Rosja/Kazachstan"),
            (20, "20 - Egipt"),
            (27, "27 - Południowa Afryka"),
            (30, "30 - Grecja"),
            (31, "31 - Holandia"),
            (32, "32 - Belgia"),
            (33, "33 - Francja"),
            (34, "34 - Hiszpania"),
            (36, "36 - Węgry"),
            (39, "39 - Włochy"),
            (40, "40 - Rumunia"),
            (41, "41 - Szwajcaria"),
            (43, "43 - Austria"),
            (44, "44 - Wielka Brytania"),
            (45, "45 - Dania"),
            (46, "46 - Szwecja"),
            (47, "47 - Norwegia"),
            (48, "48 - Polska"),
            (49, "49 - Niemcy"),
            (51, "51 - Peru"),
            (52, "52 - Meksyk"),
            (53, "53 - Kuba"),
            (54, "54 - Argentyna"),
            (55, "55 - Brazylia"),
            (56, "56 - Chile"),
            (57, "57 - Kolumbia"),
            (58, "58 - Wenezuela"),
            (60, "60 - Malezja"),
            (61, "61 - Australia"),
            (62, "62 - Indonezja"),
            (63, "63 - Filipiny"),
            (64, "64 - Nowa Zelandia"),
            (65, "65 - Singapur"),
            (66, "66 - Tajlandia"),
            (81, "81 - Japonia"),
            (82, "82 - Korea Południowa"),
            (84, "84 - Wietnam"),
            (86, "86 - Chiny"),
            (90, "90 - Turcja"),
            (91, "91 - Indie"),
            (92, "92 - Pakistan"),
            (93, "93 - Afganistan"),
            (94, "94 - Sri Lanka"),
            (95, "95 - Mjanma (Birma)"),
            (98, "98 - Iran"),
            (212, "212 - Maroko"),
            (213, "213 - Algieria"),
            (216, "216 - Tunezja"),
            (218, "218 - Libia"),
            (220, "220 - Gambia"),
            (221, "221 - Senegal"),
            (222, "222 - Mauretania"),
            (223, "223 - Mali"),
            (224, "224 - Gwinea"),
            (225, "225 - Wybrzeże Kości Słoniowej"),
            (226, "226 - Burkina Faso"),
            (227, "227 - Niger"),
            (228, "228 - Togo"),
            (229, "229 - Benin"),
            (230, "230 - Mauritius"),
            (231, "231 - Liberia"),
            (232, "232 - Sierra Leone"),
            (233, "233 - Ghana"),
            (234, "234 - Nigeria"),
            (235, "235 - Czad"),
            (236, "236 - Republika Środkowoafrykańska"),
            (237, "237 - Kamerun"),
            (238, "238 - Wyspy Zielonego Przylądka"),
            (239, "239 - Wyspy Świętego Tomasza i Książęca"),
            (240, "240 - Gwinea Równikowa"),
            (241, "241 - Gabon"),
            (242, "242 - Kongo"),
            (243, "243 - Demokratyczna Republika Konga"),
            (244, "244 - Angola"),
            (245, "245 - Gwinea Bissau"),
            (246, "246 - Diego Garcia"),
            (247, "247 - Wyspa Wniebowstąpienia"),
            (248, "248 - Seszele"),
            (249, "249 - Sudan"),
            (250, "250 - Rwanda"),
            (251, "251 - Etiopia"),
            (252, "252 - Somalia"),
            (253, "253 - Dżibuti"),
            (254, "254 - Kenia"),
            (255, "255 - Tanzania"),
            (256, "256 - Uganda"),
            (257, "257 - Burundi"),
            (258, "258 - Mozambik"),
            (260, "260 - Zambia"),
            (261, "261 - Madagaskar"),
            (262, "262 - Reunion"),
            (263, "263 - Zimbabwe"),
            (264, "264 - Namibia"),
            (265, "265 - Malawi"),
            (266, "266 - Lesotho"),
            (267, "267 - Botswana"),
            (268, "268 - Eswatini"),
            (269, "269 - Komory"),
            (290, "290 - Wyspa Świętej Heleny"),
            (291, "291 - Erytrea"),
            (297, "297 - Aruba"),
            (298, "298 - Wyspy Owcze"),
            (299, "299 - Grenlandia"),
            (350, "350 - Gibraltar"),
            (351, "351 - Portugalia"),
            (352, "352 - Luksemburg"),
            (353, "353 - Irlandia"),
            (354, "354 - Islandia"),
            (355, "355 - Albania"),
            (356, "356 - Malta"),
            (357, "357 - Cypr"),
            (358, "358 - Finlandia"),
            (359, "359 - Bułgaria"),
            (370, "370 - Litwa"),
            (371, "371 - Łotwa"),
            (372, "372 - Estonia"),
            (373, "373 - Mołdawia"),
            (374, "374 - Armenia"),
            (375, "375 - Białoruś"),
            (376, "376 - Andora"),
            (377, "377 - Monako"),
            (378, "378 - San Marino"),
            (379, "379 - Watykan"),
            (380, "380 - Ukraina"),
            (381, "381 - Serbia"),
            (382, "382 - Czarnogóra"),
            (383, "383 - Kosowo"),
            (385, "385 - Chorwacja"),
            (386, "386 - Słowenia"),
            (387, "387 - Bośnia i Hercegowina"),
            (389, "389 - Macedonia Północna"),
            (420, "420 - Czechy"),
            (421, "421 - Słowacja"),
            (423, "423 - Liechtenstein"),
            (500, "500 - Falklandy"),
            (501, "501 - Belize"),
            (502, "502 - Gwatemala"),
            (503, "503 - Salwador"),
            (504, "504 - Honduras"),
            (505, "505 - Nikaragua"),
            (506, "506 - Kostaryka"),
            (507, "507 - Panama"),
            (508, "508 - Saint-Pierre i Miquelon"),
            (509, "509 - Haiti"),
            (590, "590 - Gwadelupa"),
            (591, "591 - Boliwia"),
            (592, "592 - Gujana"),
            (593, "593 - Ekwador"),
            (594, "594 - Gujana Francuska"),
            (595, "595 - Paragwaj"),
            (596, "596 - Martynika"),
            (597, "597 - Surinam"),
            (598, "598 - Urugwaj"),
            (599, "599 - Antyle Holenderskie"),
            (670, "670 - Timor Wschodni"),
            (672, "672 - Norfolk"),
            (673, "673 - Brunei"),
            (674, "674 - Nauru"),
            (675, "675 - Papua-Nowa Gwinea"),
            (676, "676 - Tonga"),
            (677, "677 - Wyspy Salomona"),
            (678, "678 - Vanuatu"),
            (679, "679 - Fidżi"),
            (680, "680 - Palau"),
            (681, "681 - Wallis i Futuna"),
            (682, "682 - Wyspy Cooka"),
            (683, "683 - Niue"),
            (685, "685 - Samoa"),
            (686, "686 - Kiribati"),
            (687, "687 - Nowa Kaledonia"),
            (688, "688 - Tuvalu"),
            (689, "689 - Polinezja Francuska"),
            (690, "690 - Tokelau"),
            (691, "691 - Mikronezja"),
            (692, "692 - Wyspy Marshalla"),
            (850, "850 - Korea Północna"),
            (852, "852 - Hongkong"),
            (853, "853 - Makau"),
            (855, "855 - Kambodża"),
            (856, "856 - Laos"),
            (880, "880 - Bangladesz"),
            (886, "886 - Tajwan"),
            (960, "960 - Malediwy"),
            (961, "961 - Liban"),
            (962, "962 - Jordania"),
            (963, "963 - Syria"),
            (964, "964 - Irak"),
            (965, "965 - Kuwejt"),
            (966, "966 - Arabia Saudyjska"),
            (967, "967 - Jemen"),
            (968, "968 - Oman"),
            (970, "970 - Palestyna"),
            (971, "971 - Zjednoczone Emiraty Arabskie"),
            (972, "972 - Izrael"),
            (973, "973 - Bahrajn"),
            (974, "974 - Katar"),
            (975, "975 - Bhutan"),
            (976, "976 - Mongolia"),
            (977, "977 - Nepal"),
            (992, "992 - Tadżykistan"),
            (993, "993 - Turkmenistan"),
            (994, "994 - Azerbejdżan"),
            (995, "995 - Gruzja"),
            (996, "996 - Kirgistan"),
            (998, "998 - Uzbekistan"),
        ]
        
        # Sortowanie po nazwie kraju dla łatwiejszego wyszukiwania
        return sorted(COUNTRY_CODES, key=lambda x: x[1])